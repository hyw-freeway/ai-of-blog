# 用 AI 从零搭建个人博客：Cursor + React + Node.js 全栈实践

## 前言

这是一个**完全由 AI 辅助开发**的个人博客项目。我使用 [Cursor](https://cursor.sh)（一款 AI 驱动的代码编辑器）作为开发工具，通过自然语言描述需求，让 AI 帮我完成了从架构设计、代码编写到部署上线的全过程。

本文将详细介绍这个项目的技术实现，并在最后反思 AI 生成代码的不足之处，以及如何更好地与 AI 协作开发。

## 项目概述

### 功能特性

- **访客**：浏览文章列表、查看文章详情、搜索文章
- **管理员**：登录认证、发布/编辑/删除文章、上传图片和文件
- **响应式设计**：适配电脑、平板、手机

### 在线演示

- **前端**：[https://ai-of-blog.vercel.app](https://ai-of-blog.vercel.app)
- **后端 API**：[https://ai-of-blog.onrender.com](https://ai-of-blog.onrender.com)
- **源码**：[GitHub](https://github.com/hyw-freeway/ai-of-blog)

## 技术选型

### 前端技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| React | 19 | 用户界面构建 |
| Vite | 7.x | 开发构建工具 |
| React Router | 7.x | 前端路由管理 |
| Axios | - | HTTP 请求处理 |
| EasyMDE | - | Markdown 编辑器 |
| marked | - | Markdown 渲染 |

### 后端技术栈

| 技术 | 用途 |
|------|------|
| Node.js | 运行时环境 |
| Express | Web 框架 |
| JWT | 身份认证 |
| Multer | 文件上传处理 |
| mysql2 | 数据库驱动 |

### 数据库与部署

| 组件 | 服务商 | 说明 |
|------|--------|------|
| 数据库 | TiDB Cloud | MySQL 兼容，Serverless 免费版 |
| 后端 | Render | Node.js 托管，免费版 |
| 前端 | Vercel | 静态网站托管，免费版 |

## 系统架构

```
┌─────────────────────────────────────────────────────────────┐
│                         用户浏览器                           │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────┐
│                    Vercel (前端托管)                         │
│                   React + Vite 静态页面                      │
│                   ai-of-blog.vercel.app                     │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼ API 请求 (HTTPS)
┌─────────────────────────────────────────────────────────────┐
│                    Render (后端托管)                         │
│                  Node.js + Express API                       │
│                  ai-of-blog.onrender.com                    │
└─────────────────────────────────────────────────────────────┘
                              │
                              ▼ SQL 查询 (SSL)
┌─────────────────────────────────────────────────────────────┐
│                   TiDB Cloud (数据库)                        │
│                      MySQL 兼容                              │
└─────────────────────────────────────────────────────────────┘
```

## 核心功能实现

### 1. JWT 用户认证

```javascript
// 生成 Token
const generateToken = (user) => {
  return jwt.sign(
    { userId: user.id, username: user.username },
    process.env.JWT_SECRET,
    { expiresIn: process.env.JWT_EXPIRES_IN || '7d' }
  );
};

// 验证中间件
const authMiddleware = (req, res, next) => {
  const authHeader = req.headers.authorization;
  if (!authHeader || !authHeader.startsWith('Bearer ')) {
    return res.error('未登录或登录已过期', 401);
  }

  const token = authHeader.split(' ')[1];
  try {
    const decoded = jwt.verify(token, process.env.JWT_SECRET);
    req.user = decoded;
    next();
  } catch (err) {
    res.error('登录已过期，请重新登录', 401);
  }
};
```

### 2. RESTful API 设计

| 接口 | 方法 | 功能 | 权限 |
|------|------|------|------|
| `/api/articles` | GET | 获取文章列表 | 公开 |
| `/api/articles/:id` | GET | 获取文章详情 | 公开 |
| `/api/articles` | POST | 发布文章 | 需登录 |
| `/api/articles/:id` | PUT | 编辑文章 | 需登录 |
| `/api/articles/:id` | DELETE | 删除文章 | 需登录 |
| `/api/auth/login` | POST | 管理员登录 | 公开 |
| `/api/upload/image` | POST | 上传图片 | 需登录 |
| `/api/upload/file` | POST | 上传文件 | 需登录 |

### 3. 文件上传与中文文件名处理

```javascript
// 修复 Multer 中文编码问题
const decodeFileName = (filename) => {
  try {
    return Buffer.from(filename, 'latin1').toString('utf8');
  } catch (e) {
    return filename;
  }
};

// 生成唯一文件名
const generateFileName = (originalName) => {
  const ext = path.extname(originalName);
  const timestamp = Date.now();
  const random = Math.random().toString(36).substring(2, 8);
  return `${timestamp}-${random}${ext}`;
};
```

### 4. 云数据库 SSL 连接

```javascript
// TiDB Cloud 需要 SSL 连接
const pool = mysql.createPool({
  host: process.env.DB_HOST,
  port: process.env.DB_PORT || 3306,
  user: process.env.DB_USER,
  password: process.env.DB_PASSWORD,
  database: process.env.DB_NAME,
  ssl: process.env.DB_SSL === 'true' ? {
    rejectUnauthorized: true
  } : undefined
});
```

### 5. Markdown 编辑器集成

使用 EasyMDE 编辑器，支持自定义工具栏按钮实现图片/文件上传：

```javascript
{
  name: 'upload-image',
  action: (editor) => {
    const input = document.createElement('input');
    input.type = 'file';
    input.accept = 'image/*';
    input.onchange = async (e) => {
      const file = e.target.files?.[0];
      if (!file) return;
      
      const res = await uploadImage(file);
      if (res.code === 200) {
        const cm = editor.codemirror;
        const cursor = cm.getCursor();
        cm.replaceRange(`![${res.data.originalName}](${fileUrl})`, cursor);
        cm.focus();
      }
    };
    input.click();
  },
  className: 'fa fa-image',
  title: '上传图片',
}
```

## 设计风格

采用 **Squarespace + Linear + Notion** 极简高级风：

- **配色**：低饱和度，以白色和浅灰为主，蓝色作为强调色
- **排版**：大量留白，内容居中，宽松的行高和段落间距
- **交互**：柔和阴影，精致圆角，微妙的 hover 动画

```css
:root {
  --color-bg: #fafafa;
  --color-surface: #ffffff;
  --color-text-primary: #1a1a1a;
  --color-accent: #2563eb;
  --shadow-sm: 0 1px 2px rgba(0,0,0,0.04);
  --radius-md: 12px;
}
```

## 自动化部署

配置 GitHub 集成后，代码更新自动触发部署：

```bash
# 修改代码后
git add .
git commit -m "功能更新"
git push

# Render（后端）和 Vercel（前端）自动检测并重新部署
```

---

## AI 协作开发回顾

### 与 Cursor AI 的协作过程

整个项目开发过程中，我主要通过以下方式与 AI 协作：

1. **需求描述**：用自然语言描述想要的功能
2. **代码生成**：AI 生成代码，我进行审核
3. **问题修复**：遇到 bug 时描述现象，AI 定位并修复
4. **迭代优化**：不断提出改进需求，AI 逐步完善

### AI 生成代码的优点

1. **开发速度快**：从零到上线只用了几个小时
2. **代码规范**：生成的代码结构清晰，注释完整
3. **最佳实践**：自动采用了 JWT 认证、RESTful API 等业界标准
4. **问题解决能力强**：SSL 连接、中文编码等问题都能快速定位和修复

---

## 技术不足分析

尽管项目已经可以正常运行，但从专业角度审视，AI 生成的代码存在以下不足：

### 1. 安全性不足

| 问题 | 现状 | 建议改进 |
|------|------|----------|
| 密码存储 | 明文存储 | 使用 bcrypt 加密 |
| SQL 注入 | 基本防护 | 增加输入验证和参数化查询 |
| XSS 攻击 | 未处理 | 对用户输入进行转义 |
| CORS 配置 | 允许所有来源 | 配置白名单 |
| 文件上传 | 仅检查扩展名 | 增加文件内容校验 |

### 2. 性能优化缺失

- **无缓存机制**：每次请求都查询数据库
- **无分页优化**：大量文章时性能会下降
- **图片未压缩**：上传的图片未进行压缩处理
- **无 CDN**：静态资源未使用 CDN 加速

### 3. 功能不完善

- **无评论系统**：缺少读者互动功能
- **无分类/标签页**：标签只是展示，无法点击筛选
- **无访问统计**：无法了解文章阅读量
- **无 SEO 优化**：缺少 meta 标签、sitemap 等

### 4. 代码质量问题

- **错误处理不完善**：部分异常情况未处理
- **缺少单元测试**：没有自动化测试保障
- **状态管理简陋**：未使用 Redux/Zustand 等状态管理库
- **TypeScript 缺失**：使用 JavaScript，缺少类型检查

### 5. 架构设计局限

- **单体应用**：后端是单体架构，难以扩展
- **无日志系统**：缺少日志记录和监控
- **无备份机制**：数据库没有自动备份

---

## 如何更好地向 AI 描述需求

基于这次开发经验，以下是向 AI 描述需求时的改进建议：

### 1. 明确安全要求

```
❌ 不好的描述：
"帮我实现用户登录功能"

✅ 更好的描述：
"帮我实现用户登录功能，要求：
- 密码使用 bcrypt 加密存储（cost factor = 10）
- 登录失败次数限制（5次锁定15分钟）
- JWT token 中不存储敏感信息
- 实现 CSRF 防护"
```

### 2. 指定性能要求

```
❌ 不好的描述：
"帮我实现文章列表接口"

✅ 更好的描述：
"帮我实现文章列表接口，要求：
- 支持分页（每页10条，使用游标分页）
- 使用 Redis 缓存热门文章（TTL 5分钟）
- 返回结果只包含必要字段，不返回完整内容
- 支持按标签筛选"
```

### 3. 要求完善的错误处理

```
❌ 不好的描述：
"帮我实现文件上传"

✅ 更好的描述：
"帮我实现文件上传，要求：
- 限制文件大小（图片5MB，其他文件20MB）
- 校验文件 MIME 类型（不只是扩展名）
- 上传失败时返回具体错误原因
- 支持断点续传
- 上传完成后生成缩略图"
```

### 4. 要求编写测试

```
"为这个功能编写单元测试，覆盖以下场景：
- 正常情况
- 边界条件（空输入、超长输入）
- 异常情况（网络错误、数据库错误）"
```

### 5. 分阶段迭代

不要一次性描述所有需求，而是分阶段迭代：

```
第一阶段：核心功能
"先实现最基本的文章 CRUD 功能"

第二阶段：安全加固
"现在给这个系统添加安全防护..."

第三阶段：性能优化
"添加缓存和分页优化..."

第四阶段：功能扩展
"增加评论、统计等功能..."
```

### 6. 提供技术约束

```
"请使用以下技术栈和约束：
- TypeScript（strict 模式）
- ESLint + Prettier 代码规范
- 使用 Zod 进行输入验证
- 所有异步操作使用 try-catch
- 遵循 RESTful API 设计规范"
```

---

## 总结

通过 AI 辅助开发这个博客项目，我深刻体会到：

### AI 的优势

- **大幅提升开发效率**：几小时完成原本需要几天的工作
- **降低学习门槛**：不熟悉的技术也能快速实现
- **代码质量有保障**：基本遵循最佳实践

### AI 的局限

- **安全意识不足**：需要人工指定安全要求
- **缺乏全局视角**：难以考虑到所有边界情况
- **性能优化被动**：不主动考虑性能问题

### 最佳协作方式

**AI 是优秀的执行者，但需要人类做好架构师和审核者的角色。**

1. **人类负责**：需求分析、架构设计、安全审计、代码审核
2. **AI 负责**：代码实现、问题修复、文档生成

未来，随着 AI 能力的提升，这种人机协作的开发模式将会越来越普遍。关键是学会如何更好地与 AI 沟通，让它成为我们强大的开发助手。

---

**项目地址**：[GitHub](https://github.com/hyw-freeway/ai-of-blog)

**在线演示**：[https://ai-of-blog.vercel.app](https://ai-of-blog.vercel.app)

*本文由 AI 辅助撰写，人工审核修改。*
